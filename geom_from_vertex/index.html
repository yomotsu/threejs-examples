<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>customGeometry : THREE.js</title>
<style>
body{
	font-family:Arial, Helvetica, sans-serif;
	background:#333;
}
canvas{
	position:absolute;
	top:0;
	left:0;
}
</style>
<script src="../lib/Three_r49.js"></script>
<script>
window.addEventListener( 'DOMContentLoaded', function(){
	var width = window.innerWidth;
	var height = window.innerHeight;
	
	var scene = new THREE.Scene();
	
	var camera = new THREE.PerspectiveCamera( 40, width / height, 1, 1000 );
	camera.position.z = 100;
	scene.add( camera );
	
	var renderer = new THREE.WebGLRenderer();
	renderer.setSize( width, height );
	document.body.appendChild( renderer.domElement );
	
	var geom = new THREE.Geometry();
	
	//頂点は後で法線出しやすいように、時計回り, 反時計回りどちらかに統一しておく
	// 1
	var v1 = new THREE.Vector3( 0,   0, 0);
	var v2 = new THREE.Vector3(30, -30, 0);
	var v3 = new THREE.Vector3(30,  30, 0);
	geom.vertices.push(v1);
	geom.vertices.push(v2);
	geom.vertices.push(v3);
	
	var face = new THREE.Face3( 0, 1, 2 );
	face.normal = new THREE.Vector3(0, 0, 1); //法線の方向. 今回はとりあえず決め打ちにしとく
//	face.normal = (function (){
//		var vx = (v1.y - v3.y) * (v2.z - v3.z) - (v1.z - v3.z) * (v2.y - v3.y);
//		var vy = (v1.z - v3.z) * (v2.x - v3.x) - (v1.x - v3.x) * (v2.z - v3.z);
//		var vz = (v1.x - v3.x) * (v2.y - v3.y) - (v1.y - v3.y) * (v2.x - v3.x);
//		var va = Math.sqrt( Math.pow(vx,2) +Math.pow(vy,2)+Math.pow(vz,2));
//		return new THREE.Vector3( vx/va, vy/va, vz/va);
//	})();
	geom.faces.push( face );
	
	// 2
	var v1 = new THREE.Vector3(  0,   0, 0);
	var v2 = new THREE.Vector3( 30, -30, 0);
	var v3 = new THREE.Vector3(-30, -30, 0);
	geom.vertices.push(v1);
	geom.vertices.push(v2);
	geom.vertices.push(v3);
	
	var face = new THREE.Face3( 3, 4, 5 );
	face.normal = new THREE.Vector3(0, 0, 1);
	geom.faces.push( face );
	
	// 3
	var v1 = new THREE.Vector3(  0,   0, 0);
	var v2 = new THREE.Vector3(-30, -30, 0);
	var v3 = new THREE.Vector3(-30,  30, 0);
	geom.vertices.push(v1);
	geom.vertices.push(v2);
	geom.vertices.push(v3);
	
	var face = new THREE.Face3( 6, 7, 8 );
	face.normal = new THREE.Vector3(0, 0, 1);
	geom.faces.push( face );
	
	// 4
	var v1 = new THREE.Vector3(  0,   0, 0);
	var v2 = new THREE.Vector3(-30,  30, 0);
	var v3 = new THREE.Vector3( 30,  30, 0);
	geom.vertices.push(v1);
	geom.vertices.push(v2);
	geom.vertices.push(v3);
	
	var face = new THREE.Face3( 9, 10, 11 );
	face.normal = new THREE.Vector3(0, 0, 1);
	geom.faces.push( face );
	
	
	//geom.computeFaceNormals();
	var mesh= new THREE.Mesh(
		geom,
		new THREE.MeshBasicMaterial( { color: 0xFF0000, shading: THREE.FlatShading, wireframe: true } )
	);
	scene.add(mesh);
	
	renderer.render( scene, camera );
}, false);
</script>
</head>
<body>

</body>
</html>